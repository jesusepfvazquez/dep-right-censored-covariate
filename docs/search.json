[{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"1. Introduction","title":"ODRCC Tutorial","text":"ODRCC package implements robust efficient estimators regression models key covariate right-censored outcome-dependent way. many applications, observe continuous outcome YY fully observed covariates ZZ, auxiliary variable AA (represents age), covariate interest XX right-censored CC, observe W=min(X,C),D=(X≤C). W = \\min(X, C), \\quad D = (X \\le C). common modeling strategy work transformed covariate (indicating time event) AW=−X, AW = - X,  fit regression form Y=β0+β1AW+β2Z+ϵ, Y = \\beta_0 + \\beta_1 AW + \\beta_2 Z + \\epsilon,  ϵ\\epsilon mean-zero noise. complete-case estimator discards subjects D=0D=0, leading : loss efficiency, potential bias censoring depends outcome (outcome-dependent censoring). ODRCC provides several estimators remain consistent can improve efficiency: IPW: inverse probability weighting using model C∣(Y,Z)C \\mid (Y, Z) MLE: likelihood-based estimator using model X∣ZX \\mid Z AIPW: augmented IPW estimator AIPW-Λ\\Lambda: closed-form augmentation variant based robust matrix Λ\\Lambda adjustment vignette walks typical analysis workflow simulated data.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"load-the-package-and-simulate-data","dir":"Articles","previous_headings":"","what":"2. Load the package and simulate data","title":"ODRCC Tutorial","text":"use internal data-generating function data_aft() simulates data AFT-type model outcome-dependent censoring XX. simulated dataset: y = outcome Z = covariate = auxiliary variable (age) X = true covariate (subject censoring) C = censoring time W = min(X, C) D = (X ≤ C) AX = - X; representing time event (e.g., diagnosis) AW = - W; coarsened version AX various weight variables (e.g., myp_ywz, myp_ywz_oracle, etc.) regression ’ll use working model Y∼AW+Z Y \\sim AW + Z R ","code":"devtools::load_all(\".\") #> ℹ Loading ODRCC #> Warning: replacing previous import 'geex::coef' by 'stats::coef' when loading #> 'ODRCC' library(dplyr) #>  #> Attaching package: 'dplyr' #>  #> The following objects are masked from 'package:stats': #>  #>     filter, lag #>  #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(tictoc) # to time the functions set.seed(2025)  n <- 300 dat <- data_aft(nSubjects = n)  str(dat) #> 'data.frame':    300 obs. of  18 variables: #>  $ y             : num  -1.53 1.6 -3.16 4.02 1.65 ... #>  $ Z             : num  0.6208 0.0356 0.7732 1.2725 0.371 ... #>  $ D             : num  1 0 0 1 0 0 1 1 0 1 ... #>  $ A             : num  1.1 1.66 2.1 0.97 1.03 ... #>  $ X             : num  4.261 1.547 6.573 0.417 0.666 ... #>  $ AX            : num  -3.156 0.116 -4.478 0.553 0.361 ... #>  $ C             : num  5.143 0.13 0.152 4.78 0.532 ... #>  $ W             : num  4.261 0.13 0.152 0.417 0.532 ... #>  $ AW            : num  -3.156 1.532 1.943 0.553 0.495 ... #>  $ meanCYZ       : num  7.96 1.25 19.41 0.69 1.44 ... #>  $ meanXZ        : num  2.89 2.73 2.94 3.09 2.82 ... #>  $ b             : int  1 2 3 4 5 6 7 8 9 10 ... #>  $ myp_uniform   : num  0.612 0.139 0.489 0.238 0.8 ... #>  $ myp_ywz_oracle: num [1:300, 1] 0.481 0.724 0.915 0.46 0.544 ... #>  $ myp_ywz       : num  0.57 0.731 0.94 0.525 0.575 ... #>  $ meanXD0YZ     : num  4.914 1.296 6.547 0.895 1.336 ... #>  $ AX_yz         : num  -3.156 0.366 -4.452 0.553 -0.309 ... #>  $ AX_z          : num  -3.156 -1.429 -1.232 0.553 -2.169 ... summary(dat$D) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>  0.0000  0.0000  0.0000  0.4367  1.0000  1.0000 model <- y ~ AW + Z"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"complete-case-cc-estimator","dir":"Articles","previous_headings":"","what":"3. Complete-case (CC) estimator","title":"ODRCC Tutorial","text":"complete-case estimator uses subjects D=1D=1 (uncensored XX), fitting standard linear model via M-estimation: estimate_beta_cc() returns: beta_est: matrix regression coefficients ψ̂\\hat\\psi se_est: corresponding standard errors β\\beta can inspect :","code":"tic() est_cc <- estimate_beta_cc(dat, model = model) est_cc #> $beta_est #>                                  psi_updated #> [1,] 0.7097358 0.9449989 1.05793   0.9196435 #>  #> $se_est #>            [,1]       [,2]       [,3] #> [1,] 0.08382001 0.02902404 0.08175951 toc() #> 0.232 sec elapsed cc_beta <- est_cc$beta_est cc_se   <- est_cc$se_est  cc_beta #>                                  psi_updated #> [1,] 0.7097358 0.9449989 1.05793   0.9196435 cc_se #>            [,1]       [,2]       [,3] #> [1,] 0.08382001 0.02902404 0.08175951"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"ipw-estimator","dir":"Articles","previous_headings":"","what":"4. IPW estimator","title":"ODRCC Tutorial","text":"IPW estimator uses weights based estimated probability XX observed, typically modeling fC∣Y,Z(w,y,z) f_{C \\mid Y, Z}(w,y,z) AFT model. package version, user supplies formula weighting model, e.g. ~ y + Z, function internally fits Weibull AFT via survreg(). specify IPW estimator AFT-based weighting model: Extract coefficients standard errors: want robust sandwich SEs dedicated variance function:","code":"# outcome model model <- y ~ AW + Z  # weights model: C | Y, Z model_weights <- ~ y + Z  tic(\"IPW Estimator:\") est_ipw <- estimate_beta_ipw(   data_yXZ      = dat,   model         = model,   model_weights = model_weights ) est_ipw #> $beta_est #>                                  psi_updated #> [1,] 0.896712 0.9327407 1.041258    0.940482 #>  #> $se_est #>            [,1]       [,2]       [,3] #> [1,] 0.09242807 0.03129192 0.08593062 toc() #> IPW Estimator:: 0.112 sec elapsed ipw_beta <- est_ipw$beta_est ipw_se   <- est_ipw$se_est  ipw_beta #>                                  psi_updated #> [1,] 0.896712 0.9327407 1.041258    0.940482 ipw_se #>            [,1]       [,2]       [,3] #> [1,] 0.09242807 0.03129192 0.08593062 # Suppose est_ipw$beta_est is a 1 x p matrix including psi at the end theta_ipw <- as.numeric(est_ipw$beta_est)  tic(\"IPW Estimator-Robust Sandwich Estimator:\") var_ipw <- var_beta_ipw(   data_yXZ = dat,   theta  = theta_ipw,   model         = model,   model_weights = model_weights ) #> IPW sandwich: finished bread (A matrix). #> IPW sandwich: finished meat (B matrix). var_ipw$se_est #> [1] 0.08722834 0.03090214 0.08429156 toc() #> IPW Estimator-Robust Sandwich Estimator:: 57.557 sec elapsed"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"maximum-likelihood-estimator-mle","dir":"Articles","previous_headings":"","what":"5. Maximum Likelihood estimator (MLE)","title":"ODRCC Tutorial","text":"MLE approach uses joint model, combining: outcome model fY∣X,Zf_{Y \\mid X, Z}, model fX∣Zf_{X \\mid Z} (Weibull AFT), integrates censored XX. corresponding sandwich variance:","code":"model_xz = as.formula(\"~Z\")  tic(\"MLE:\") est_mle = estimate_beta_mle(     data_yXZ = dat,     model = model,     aw_var   = \"AW\",     model_weights = model_weights,     model_xz = model_xz,     trace = 0 # Set to 0 if no trace wanted, 1 otherwise ) #> Maximizing -- use negfn and neggr est_mle #> $beta_est #> [1] 0.9023008 0.9555097 0.9955888 0.9686213 #>  #> $gamma_est #> [1] 0.96285840 0.08246286 0.81313123 toc() #> MLE:: 1221.958 sec elapsed theta_mle <- as.numeric(c(est_mle$beta_est,est_mle$gamma_est))  tic(\"MLE-Robust Sandwich Estimator:\") var_mle <- var_beta_mle(     data_yXZ = dat,     theta = theta_mle,     model = model,     aw_var   = \"AW\",     model_xz = model_xz ) var_mle$se_beta #> [1] 0.07210658 0.02842251 0.07155912 toc() #> MLE-Robust Sandwich Estimator:: 429.883 sec elapsed"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"augmented-ipw-aipw-estimator","dir":"Articles","previous_headings":"","what":"6. Augmented IPW (AIPW) estimator","title":"ODRCC Tutorial","text":"AIPW estimator combines IPW augmentation term providing improved efficiency. package version, supply: model: outcome model, e.g. y ~ AW + Z model_weights: censoring model fC|(Y,Z)f_{C | (Y, Z)} model_xz: covariate structure X|ZX | Z (RHS-formula, e.g. ~ Z) AIPW sandwich SEs:","code":"model_xz <- ~ Z  tic(\"AIPW:\") est_aipw <- estimate_beta_aipw(   data_yXZ      = dat,   model         = model,   model_weights = model_weights,   model_xz      = model_xz,   aw_var        = \"AW\",   lbound        = 0,   ubound        = 50 ) est_aipw #> $beta_est #>           [,1]      [,2]    [,3]      [,4] #> [1,] 0.8801625 0.9578444 1.12362 0.9381438 #>  #> $beta_se #>            [,1]      [,2]      [,3] #> [1,] 0.09291546 0.0327527 0.1126476 toc() #> AIPW:: 1611.002 sec elapsed # est_aipw$beta_est is 1 x p, est_aipw$psi_est is scalar theta_aipw <- c(as.numeric(est_aipw$beta_est)) # theta_aipw <- c(as.numeric(est_ipw$beta_est))  tic(\"AIPW Estimator-Robust Sandwich Estimator:\") var_aipw <- var_beta_aipw(   data_yXZ = dat,   theta  = theta_aipw,   lbound        = 0,   ubound        = 50 ) var_aipw$se_est #> [1] 0.07964022 0.02990928 0.07936218 toc() #> AIPW Estimator-Robust Sandwich Estimator:: 63.627 sec elapsed"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"aipwlambda-estimator-closed-form-augmentation","dir":"Articles","previous_headings":"","what":"7. AIPW–Lambda estimator (closed-form augmentation)","title":"ODRCC Tutorial","text":"AIPW–Lambda estimator uses approximation augmentation term admits closed-form expression specific modeling assumptions fX|Zf_{X | Z}. provides computationally cheaper alternative full numerical AIPW. Variance via dedicated robust sandwiich estimator function:","code":"tic(\"AIPW with Lambda Estimator:\") est_aipw_lambda <- estimate_beta_aipw_lambda(     data_yXZ = dat,     model = model,     model_weights = model_weights,     aw_var  = \"AW\" )  est_aipw_lambda #> $beta_est #> [1] 0.8788797 0.9381677 1.0675614 0.9366018 #>  #> $se_est #>            [,1]      [,2]       [,3] #> [1,] 0.08001977 0.0291584 0.07999267 toc() #> AIPW with Lambda Estimator:: 0.379 sec elapsed theta_aipw_lambda <- as.numeric(est_aipw_lambda$beta_est)  tic(\"AIPW with Lambda Estimator-Robust Sandwich Estimator:\") var_aipw_lambda <- var_beta_aipw_lambda(   data_yXZ = dat,   mytheta  = theta_aipw_lambda ) #> AIPW with Lambda Estimator-Robust Sandwich Estimator:: 1.385 sec elapsed var_aipw_lambda$se_est #> [1] 0.08324157 0.02928765 0.08407404 toc()"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/articles/ODRCC-tutorial.html","id":"comparing-estimators","dir":"Articles","previous_headings":"","what":"8. Comparing estimators","title":"ODRCC Tutorial","text":"estimators run, can collect compare . Note oracle value 1 across . corresponding nuisance-adjusted standard errors :","code":"compare_beta <- rbind(   CC      = est_cc$beta_est,   IPW     = est_ipw$beta_est,   MLE     = est_mle$beta_est,   AIPW    = est_aipw$beta_est,   AIPW_Lambda  = est_aipw_lambda$beta_est )  row.names(compare_beta) = c(\"CC\", \"IPW\", \"MLE\", \"AIPW\", \"AIPW-Lambda\") colnames(compare_beta) = c(\"beta0\", \"beta1\", \"beta2\", \"sigma\") compare_beta #>                 beta0     beta1     beta2     sigma #> CC          0.7097358 0.9449989 1.0579300 0.9196435 #> IPW         0.8967120 0.9327407 1.0412579 0.9404820 #> MLE         0.9023008 0.9555097 0.9955888 0.9686213 #> AIPW        0.8801625 0.9578444 1.1236203 0.9381438 #> AIPW-Lambda 0.8788797 0.9381677 1.0675614 0.9366018 se_mat <- rbind(   CC      = est_cc$se_est,   IPW     = var_ipw$se_est,   MLE     = var_mle$se_beta,   AIPW    = var_aipw$se_est,   AIPW_Lambda  = var_aipw_lambda$se_est )  row.names(se_mat) = c(\"CC\", \"IPW\", \"MLE\", \"AIPW\", \"AIPW-Lambda\") colnames(se_mat) = c(\"beta0\", \"beta1\", \"beta2\") se_mat #>                  beta0      beta1      beta2 #> CC          0.08382001 0.02902404 0.08175951 #> IPW         0.08722834 0.03090214 0.08429156 #> MLE         0.07210658 0.02842251 0.07155912 #> AIPW        0.07964022 0.02990928 0.07936218 #> AIPW-Lambda 0.08324157 0.02928765 0.08407404"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jesus Vazquez. Author, maintainer.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Vazquez J (2025). ODRCC: Tools Modeling Inference Outcome-Dependent Right-Censored Covariates. R package version 0.1.0.","code":"@Manual{,   title = {ODRCC: Tools for Modeling and Inference with Outcome-Dependent Right-Censored Covariates},   author = {Jesus Vazquez},   year = {2025},   note = {R package version 0.1.0}, }"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/ODRCC.html","id":null,"dir":"Reference","previous_headings":"","what":"ODRCC: Robust Estimation Under Outcome-Dependent Right Censoring Covariate — ODRCC","title":"ODRCC: Robust Estimation Under Outcome-Dependent Right Censoring Covariate — ODRCC","text":"ODRCC package implements robust efficient estimation estimators regression models involving outcome-dependent right-censored covariates. Available estimators inverse probability weighting (IPW), augmented IPW (AIPW), maximum likelihood (MLE).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/ODRCC.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"ODRCC: Robust Estimation Under Outcome-Dependent Right Censoring Covariate — ODRCC","text":"Vazquez, J. et al. (2025). * Robust Estimation Outcome Dependent Right Censoring Huntington Disease: Estimators Low High Censoring Rates*. Manuscript.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/ODRCC.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ODRCC: Robust Estimation Under Outcome-Dependent Right Censoring Covariate — ODRCC","text":"Jesus E. Vazquez","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/data_aft.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate AFT data with an outcome-dependent right-censored covariate — data_aft","title":"Simulate AFT data with an outcome-dependent right-censored covariate — data_aft","text":"Generates simulated dataset accelerated failure time (AFT) model right-censored covariate subject outcome-dependent censoring. function returns true covariate X, censoring time C, observed covariate W = min(X, C), event indicator D = (X <= C), several derived quantities weights conditional expectations.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/data_aft.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate AFT data with an outcome-dependent right-censored covariate — data_aft","text":"","code":"data_aft(nSubjects = 10^3)"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/data_aft.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate AFT data with an outcome-dependent right-censored covariate — data_aft","text":"nSubjects Integer. Number subjects simulate. Defaults 10^3.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/data_aft.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate AFT data with an outcome-dependent right-censored covariate — data_aft","text":"data frame nSubjects rows containing: y Continuous outcome. Z Standard normal covariate. D Event indicator (X <= C). Observed auxiliary covariate. X True covariate subject censoring. AX - X. C Censoring time. W min(X, C). AW - W. meanCYZ Mean C given (Y, Z) original scale. meanXZ Mean X given (Z) original scale. b Subject ID. myp_uniform Random weights (Uniform(0.1, 0.9)). myp_ywz_oracle Oracle survival probability P(C >= W | Y, Z). myp_ywz Estimated survival probability using Weibull AFT model. meanXD0YZ \\(E[X | D = 0, Y, Z]\\) computed numerical integration. AX_yz - X D = 1, otherwise - E[X | D = 0, Y, Z]. AX_z - X D = 1, otherwise - E[X | Z].","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate regression coefficients via M-estimation — estimate_beta","title":"Estimate regression coefficients via M-estimation — estimate_beta","text":"Estimate regression coefficients via M-estimation","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate regression coefficients via M-estimation — estimate_beta","text":"","code":"estimate_beta(data_yXZ, model)"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate regression coefficients via M-estimation — estimate_beta","text":"data_yXZ data frame containing variables model. Must include outcome y covariates. model object class formula specifying regression model y terms covariates.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate regression coefficients via M-estimation — estimate_beta","text":"list components beta_est 1 x (p + 1) matrix estimated regression coefficients residual standard deviation (last element). se_est 1 x p matrix estimated standard errors regression coefficients.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw.html","id":null,"dir":"Reference","previous_headings":"","what":"Augmented IPW (AIPW) estimator for regression parameters — estimate_beta_aipw","title":"Augmented IPW (AIPW) estimator for regression parameters — estimate_beta_aipw","text":"Fits regression model Y using augmented inverse probability weighting (AIPW) estimator setting outcome-dependent right-censored covariate. outcome model specified model, typically form y ~ AW + Z1 + ... + Zp, AW = - X.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Augmented IPW (AIPW) estimator for regression parameters — estimate_beta_aipw","text":"","code":"estimate_beta_aipw(   data_yXZ,   model,   model_weights,   model_xz,   aw_var = \"AW\",   lbound = 0,   ubound = 50 )"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Augmented IPW (AIPW) estimator for regression parameters — estimate_beta_aipw","text":"data_yXZ data frame containing least: y: outcome, : auxiliary covariate used form AW = - X, W: observed covariate W = min(X, C), D: indicator (X <= C), columns covariates model, columns covariates model_weights model_xz. model formula specifying outcome regression model, e.g. y ~ AW + Z y ~ AW + Z1 + Z2. model_weights formula specifying censoring model C | (Y, Z, ...). Typically right-hand-side formula, ~ y + Z, internally expanded Surv(W, 1 - D) ~ y + Z. model_xz formula specifying covariate structure X | Z. Typically right-hand-side , e.g. ~ Z, meaning log E[X | Z] depends covariates. RHS used. aw_var Character string giving name exposure covariate model equals - X (default \"AW\"). must appear model data_yXZ. lbound, ubound Numeric lower upper bounds numerical integration X augmentation term (defaults: 0 50).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Augmented IPW (AIPW) estimator for regression parameters — estimate_beta_aipw","text":"list components beta_est 1 x p matrix estimated regression coefficients \\(\\hat \\beta\\). psi_est Scalar, estimated residual standard deviation \\(\\hat \\psi\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Augmented IPW (AIPW) estimator for regression parameters — estimate_beta_aipw","text":"AIPW estimator combines: IPW component based censoring model C | (Y, Z, ...) specified model_weights. augmentation component integrates conditional distribution X | Z specified gamma_x model_xz. function solves AIPW estimating equations regression parameters \\(\\beta\\), treating nuisance models plug-, returns \\(\\hat \\beta\\) along plug-estimate residual standard deviation \\(\\hat \\psi\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"AIPW lambda-close estimator — estimate_beta_aipw_lambda","title":"AIPW lambda-close estimator — estimate_beta_aipw_lambda","text":"Fits regression model y using augmented IPW estimator closed-form (\"lambda-close\") augmentation normal approximation X. implementation assumes outcome model y ~ AW + Z, AW = - X, uses single covariate Z outcome model.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"AIPW lambda-close estimator — estimate_beta_aipw_lambda","text":"","code":"estimate_beta_aipw_lambda(   data_yXZ = dat,   model = model,   model_weights = model_weights,   aw_var = \"AW\" )"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"AIPW lambda-close estimator — estimate_beta_aipw_lambda","text":"data_yXZ Data frame containing least y, , AW, W, D, Z, weight variables myp_ywz_oracle, myp_ywz, myp_uniform, myp_ywz_logit. Assumes outcome model y ~ AW + Z. model Formula outcome, currently assumed y ~ AW + Z. function checks design matrix exactly three columns: intercept, AW, Z, order. model_weights formula specifying censoring model C | (Y, Z, ...). Typically right-hand-side formula, ~ y + Z, internally expanded Surv(W, 1 - D) ~ y + Z. aw_var Character string giving name exposure covariate model equals - X (default \"AW\"). must appear model data_yXZ.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"AIPW lambda-close estimator — estimate_beta_aipw_lambda","text":"list components: beta_est 1 x 4 matrix: \\((\\hat\\beta_0, \\hat\\beta_1, \\hat\\beta_2, \\hat\\psi)\\). se_est 1 x 3 matrix standard errors \\(\\beta_0, \\beta_1, \\beta_2\\) based geex sandwich estimator.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_aipw_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"AIPW lambda-close estimator — estimate_beta_aipw_lambda","text":"estimator combines: IPW component using weights D / p, p chosen via myweight, closed-form augmentation term derived normal approximation X.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_cc.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete-case estimator for regression parameters — estimate_beta_cc","title":"Complete-case estimator for regression parameters — estimate_beta_cc","text":"Fits regression model using complete cases, defined D = 1, via M-estimation using geex framework. complete-case analogue estimate_beta, primarily intended comparison simulation studies. consistent outcome dependent censoring.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_cc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete-case estimator for regression parameters — estimate_beta_cc","text":"","code":"estimate_beta_cc(data_yXZ, model)"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_cc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete-case estimator for regression parameters — estimate_beta_cc","text":"data_yXZ data frame containing least variables model binary indicator D, D = 1 denotes complete case. model object class formula specifying regression model outcome.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_cc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete-case estimator for regression parameters — estimate_beta_cc","text":"list components beta_est 1 x (p + 1) matrix regression coefficients followed residual standard deviation (last element). se_est 1 x p matrix estimated standard errors regression coefficients.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_ipw.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse probability weighted (IPW) estimator for regression parameters — estimate_beta_ipw","title":"Inverse probability weighted (IPW) estimator for regression parameters — estimate_beta_ipw","text":"Fits regression model using inverse probability weighting, weights derived parametric model censoring distribution C | (Y, Z, ...). user supplies right-hand-side formula (e.g. ~ y + Z) used model Surv(W, 1 - D) via Weibull AFT model. resulting estimated survival probabilities W used weights IPW estimating equations.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_ipw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse probability weighted (IPW) estimator for regression parameters — estimate_beta_ipw","text":"","code":"estimate_beta_ipw(data_yXZ, model, model_weights)"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_ipw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse probability weighted (IPW) estimator for regression parameters — estimate_beta_ipw","text":"data_yXZ data frame containing variables model, well W (observed min(X, C)), D (indicator (X <= C)), covariates appearing model_weights. model formula specifying outcome regression model (e.g. y ~ AW + Z). model_weights right-hand-side formula specifying variables censoring model, e.g. ~ y + Z. expanded Surv(W, 1 - D) ~ y + Z internally.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_ipw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse probability weighted (IPW) estimator for regression parameters — estimate_beta_ipw","text":"list components beta_est 1 x (p + 1) matrix regression coefficients followed residual standard deviation (last element). se_est 1 x p matrix estimated standard errors regression coefficients.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_mle.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood-based estimator via optimx for general AW + Z model — estimate_beta_mle","title":"Likelihood-based estimator via optimx for general AW + Z model — estimate_beta_mle","text":"Fits parametric likelihood model outcome right-censored covariate using direct maximization log-likelihood optimx. outcome model specified model, typically form y ~ AW + Z1 + ... + Zp, AW = - X. distribution X | Z modeled via Weibull AFT model, whose covariate structure can specified model_xz , default, derived right-hand side model excluding AW.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_mle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood-based estimator via optimx for general AW + Z model — estimate_beta_mle","text":"","code":"estimate_beta_mle(   data_yXZ,   model,   aw_var = \"AW\",   model_weights,   model_xz = NULL,   trace = 0 )"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_mle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood-based estimator via optimx for general AW + Z model — estimate_beta_mle","text":"data_yXZ data frame containing least outcome y, auxiliary covariate , observed covariate W, event indicator D, exposure covariate AW (another name specified aw_var), additional covariates appearing model optionally model_xz. model formula specifying outcome regression model, e.g. y ~ AW + Z1 + Z2. aw_var Character string giving name exposure covariate defined - X (default \"AW\"). variable must appear right-hand side model column data_yXZ. model_weights right-hand-side formula specifying variables censoring model, e.g. ~ y + Z. expanded Surv(W, 1 - D) ~ y + Z internally. needed can compute initial “good\" estimate regression parameters using IPW estimator. model_xz Optional formula specifying AFT model X | Z. NULL (default), model X | Z taken Weibull log-mean linear (1, Z1, ..., Zp), Z1, ..., Zp covariates right-hand side model except aw_var. provided, model_xz can either full Surv formula Surv(W, D) ~ Z1 + Z2 right-hand-side formula ~ Z1 + Z2, case left-hand side Surv(W, D) filled automatically. ' @param trace Optional, set equal 1 want trace optimx model. Leave 0 want trace","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/estimate_beta_mle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood-based estimator via optimx for general AW + Z model — estimate_beta_mle","text":"list component beta_est numeric vector containing parameter vector \\(\\theta = (\\beta, \\psi, \\gamma_x, \\text{shape}_x)\\), \\(\\beta\\) outcome regression coefficients (dimension determined model), \\(\\psi\\) residual standard deviation original scale, \\(\\gamma_x\\) indexes mean \\(X | Z\\), \\(\\text{shape}_x\\) Weibull shape parameter \\(X | Z\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw.html","id":null,"dir":"Reference","previous_headings":"","what":"Sandwich variance estimator for the AIPW estimator — var_beta_aipw","title":"Sandwich variance estimator for the AIPW estimator — var_beta_aipw","text":"Computes plug-sandwich variance estimator AIPW regression estimator outcome-dependent right-censoring covariate. outcome model specified model, typically form y ~ AW + Z1 + ... + Zp, AW = - X.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sandwich variance estimator for the AIPW estimator — var_beta_aipw","text":"","code":"var_beta_aipw(data_yXZ, theta, lbound = 0, ubound = 50)"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sandwich variance estimator for the AIPW estimator — var_beta_aipw","text":"data_yXZ Data frame containing least: y: outcome, : auxiliary covariate used form AW = - X, W: observed covariate W = min(X, C), D: indicator (X <= C), covariates appearing model, covariates appearing model_weights model_xz. theta Numeric vector c(beta, psi) AIPW estimator, beta length equal number columns model.matrix(model, data_yXZ) psi residual standard deviation. lbound, ubound Numeric lower upper bounds numerical integration X augmentation term (defaults: 0, 50).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sandwich variance estimator for the AIPW estimator — var_beta_aipw","text":"list components beta_est Estimated regression coefficients \\(\\beta\\). psi_est Estimated residual standard deviation \\(\\psi\\). se_beta Sandwich standard errors \\(\\beta\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sandwich variance estimator for the AIPW estimator — var_beta_aipw","text":"AIPW estimator combines: IPW component based censoring model C | (Y, Z, ...) specified model_weights, augmentation component based AFT model X | Z specified gamma_x model_xz. function takes estimated parameter vector theta = c(beta, psi) estimate_beta_aipw_est computes sandwich variance \\(\\beta\\), treating nuisance model parameters plug-.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw_lambda.html","id":null,"dir":"Reference","previous_headings":"","what":"Sandwich variance for the AIPW-lambda estimator — var_beta_aipw_lambda","title":"Sandwich variance for the AIPW-lambda estimator — var_beta_aipw_lambda","text":"Computes sandwich variance estimator AIPW-lambda estimator outcome-dependent right-censoring covariate, using closed-form augmentation accounting estimation censoring model \\(C | (Y, Z)\\) via Gumbel/Weibull AFT model.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw_lambda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sandwich variance for the AIPW-lambda estimator — var_beta_aipw_lambda","text":"","code":"var_beta_aipw_lambda(data_yXZ, mytheta)"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw_lambda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sandwich variance for the AIPW-lambda estimator — var_beta_aipw_lambda","text":"data_yXZ Data frame containing least: y: outcome, : auxiliary covariate, AW: - X (used outcome model), W: observed W = min(X, C), D: indicator (X <= C), Z: covariate outcome censoring models, myp_ywz: weights \\(\\pi(Y, W, Z)\\) AFT model (IPW). mytheta Numeric vector c(beta0, beta1, beta2, psi) corresponding AIPW-lambda point estimates estimate_beta_aipw_lambda_close().","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw_lambda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sandwich variance for the AIPW-lambda estimator — var_beta_aipw_lambda","text":"list components: beta_est input parameter vector mytheta. se_est Sandwich standard errors \\(\\beta_0, \\beta_1, \\beta_2\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_aipw_lambda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sandwich variance for the AIPW-lambda estimator — var_beta_aipw_lambda","text":"implementation assumes outcome model y ~ AW + Z, .e., three regression coefficients \\((\\beta_0, \\beta_1, \\beta_2)\\) plus residual standard deviation \\(\\psi\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_ipw.html","id":null,"dir":"Reference","previous_headings":"","what":"Sandwich variance estimator for the IPW estimator — var_beta_ipw","title":"Sandwich variance estimator for the IPW estimator — var_beta_ipw","text":"Computes sandwich variance estimator IPW regression estimator, allowing general outcome model y ~ AW + Z1 + ... + Zp possibly different censoring model C | (Y, Z, ...) specified model_weights. censoring model fit via Weibull AFT model using survreg, corresponding Gumbel parameterization log(W) used construct weights \\(\\pi(Y, W, Z)\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_ipw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sandwich variance estimator for the IPW estimator — var_beta_ipw","text":"","code":"var_beta_ipw(data_yXZ, theta, model, model_weights)"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_ipw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sandwich variance estimator for the IPW estimator — var_beta_ipw","text":"data_yXZ data frame containing least outcome y, covariates outcome model model, observed covariate W, event indicator D, covariates appearing censoring model model_weights. theta Numeric vector parameter estimates \\((\\beta, \\psi)\\) IPW estimator. length theta must equal p_beta + 1, p_beta number regression coefficients model. model formula specifying outcome regression model, e.g. y ~ AW + Z1 + Z2. model_weights formula specifying censoring model used estimate IPW weights. Typically form ~ y + Z1 + Z2 (right-hand-side ). Internally expanded Surv(W, 1 - D) ~ y + Z1 + Z2. full Surv formula provided, right-hand side used.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_ipw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sandwich variance estimator for the IPW estimator — var_beta_ipw","text":"list components beta_est Estimated regression coefficients \\(\\beta\\). psi_est Estimated residual standard deviation \\(\\psi\\). se_beta Sandwich standard errors \\(\\beta\\). sandwich_var Full sandwich variance matrix stacked nuisance parameter vector \\(\\xi = (\\beta, \\alpha)\\), \\(\\alpha\\) parameters censoring model.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_ipw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sandwich variance estimator for the IPW estimator — var_beta_ipw","text":"parameter vector theta assumed form \\(\\theta = (\\beta, \\psi)\\), : \\(\\beta\\) regression coefficients outcome model, \\(\\psi\\) residual standard deviation original scale.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_mle.html","id":null,"dir":"Reference","previous_headings":"","what":"Sandwich variance estimator for likelihood-based estimator — var_beta_mle","title":"Sandwich variance estimator for likelihood-based estimator — var_beta_mle","text":"Computes sandwich variance estimator parameter vector \\(\\theta\\) obtained estimate_beta_likelihood_optimx. function allows general outcome model y ~ AW + Z1 + ... + Zp possibly different AFT model X | Z specified model_xz.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_mle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sandwich variance estimator for likelihood-based estimator — var_beta_mle","text":"","code":"var_beta_mle(data_yXZ, theta, model, model_xz = NULL, aw_var = \"AW\")"},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_mle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sandwich variance estimator for likelihood-based estimator — var_beta_mle","text":"data_yXZ data frame containing least outcome y, auxiliary covariate , observed covariate W, event indicator D, exposure covariate AW (another name specified aw_var), additional covariates appearing model optionally model_xz. theta Numeric vector parameter estimates, typically taken estimate_beta_mle(...)[[\"beta_est\"]]. Must ordered \\((\\beta, \\psi, \\gamma_x, \\text{shape}_x)\\). model formula specifying outcome regression model, e.g. y ~ AW + Z1 + Z2. model_xz Optional formula specifying AFT model X | Z. NULL (default), model X | Z taken Weibull log-mean linear (1, Z1, ..., Zp), Z1, ..., Zp covariates right-hand side model except aw_var. provided, model_xz can either right-hand-side formula (e.g. ~ Z1 + Z2) full Surv formula (e.g. Surv(W, D) ~ Z1 + Z2); cases, RHS used construct design X | Z. aw_var Character string giving name exposure covariate defined - X (default \"AW\"). variable must appear right-hand side model column data_yXZ.","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_mle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sandwich variance estimator for likelihood-based estimator — var_beta_mle","text":"list components beta_est Estimated regression coefficients \\(\\beta\\). psi_est Estimated residual standard deviation \\(\\psi\\). se_beta Sandwich standard errors \\(\\beta\\). se_psi Sandwich standard error \\(\\psi\\). sandwich_var Full sandwich variance matrix \\(\\theta\\).","code":""},{"path":"https://jesusepfvazquez.github.io/dep-right-censored-covariate/reference/var_beta_mle.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sandwich variance estimator for likelihood-based estimator — var_beta_mle","text":"parameter vector \\(\\theta\\) assumed form \\(\\theta = (\\beta, \\psi, \\gamma_x, \\text{shape}_x)\\), : \\(\\beta\\) regression coefficients outcome model, \\(\\psi\\) residual standard deviation original scale, \\(\\gamma_x\\) indexes (log-)mean \\(X | Z\\), \\(\\text{shape}_x\\) Weibull shape parameter \\(X | Z\\).","code":""}]
