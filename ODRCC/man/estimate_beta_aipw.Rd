% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_beta_aipw.R
\name{estimate_beta_aipw}
\alias{estimate_beta_aipw}
\title{Augmented IPW (AIPW) estimator for regression parameters}
\usage{
estimate_beta_aipw(
  data_yXZ,
  model,
  model_weights,
  model_xz,
  aw_var = "AW",
  lbound = 0,
  ubound = 50
)
}
\arguments{
\item{data_yXZ}{A data frame containing at least:
\itemize{
\item \code{y}: outcome,
\item \code{A}: auxiliary covariate used to form \code{AW = A - X},
\item \code{W}: observed covariate \code{W = min(X, C)},
\item \code{D}: indicator \code{I(X <= C)},
\item columns for the covariates in \code{model},
\item columns for the covariates in \code{model_weights} and
\code{model_xz}.
}}

\item{model}{A \code{\link[stats]{formula}} specifying the outcome
regression model, e.g. \code{y ~ AW + Z} or \code{y ~ AW + Z1 + Z2}.}

\item{model_weights}{A \code{\link[stats]{formula}} specifying the censoring
model for \code{C | (Y, Z, ...)}. Typically a right-hand-side only formula,
such as \code{~ y + Z}, which is internally expanded to
\code{Surv(W, 1 - D) ~ y + Z}.}

\item{model_xz}{A \code{\link[stats]{formula}} specifying the covariate
structure for \code{X | Z}. Typically right-hand-side only, e.g.
\code{~ Z}, meaning \code{log E[X | Z]} depends on those covariates. Only
the RHS is used.}

\item{aw_var}{Character string giving the name of the exposure covariate in
\code{model} that equals \code{A - X} (default \code{"AW"}). This must
appear in \code{model} and in \code{data_yXZ}.}

\item{lbound, ubound}{Numeric lower and upper bounds for the numerical
integration over \code{X} in the augmentation term (defaults: 0 and 50).}
}
\value{
A list with components
\describe{
\item{beta_est}{A 1 x p matrix of estimated regression coefficients
\eqn{\hat \beta}.}
\item{psi_est}{Scalar, estimated residual standard deviation \eqn{\hat \psi}.}
}
}
\description{
Fits a regression model for \code{Y} using an augmented inverse probability
weighting (AIPW) estimator in the setting of an outcome-dependent
right-censored covariate. The outcome model is specified by \code{model},
typically of the form \code{y ~ AW + Z1 + ... + Zp}, where \code{AW = A - X}.
}
\details{
The AIPW estimator combines:
\itemize{
\item An IPW component based on a censoring model for
\code{C | (Y, Z, ...)} specified by \code{model_weights}.
\item An augmentation component that integrates over the conditional
distribution \code{X | Z} specified by \code{gamma_x} and
\code{model_xz}.
}

The function solves the AIPW estimating equations for the regression
parameters \eqn{\beta}, treating the nuisance models as plug-in, and returns
\eqn{\hat \beta} along with a plug-in estimate of the residual standard
deviation \eqn{\hat \psi}.
}
