% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_beta_aipw_lambda.R
\name{estimate_beta_aipw_lambda}
\alias{estimate_beta_aipw_lambda}
\title{AIPW lambda-close estimator}
\usage{
estimate_beta_aipw_lambda(
  data_yXZ = dat,
  model = model,
  model_weights = model_weights,
  aw_var = "AW"
)
}
\arguments{
\item{data_yXZ}{Data frame containing at least
\code{y, A, AW, W, D, Z}, and the weight variables
\code{myp_ywz_oracle}, \code{myp_ywz}, \code{myp_uniform},
\code{myp_ywz_logit}. Assumes the outcome model is \code{y ~ AW + Z}.}

\item{model}{Formula for the outcome, currently assumed to be
\code{y ~ AW + Z}. The function checks that the design matrix has
exactly three columns: intercept, AW, and Z, in that order.}

\item{model_weights}{A \code{\link[stats]{formula}} specifying the censoring
model for \code{C | (Y, Z, ...)}. Typically a right-hand-side only formula,
such as \code{~ y + Z}, which is internally expanded to
\code{Surv(W, 1 - D) ~ y + Z}.}

\item{aw_var}{Character string giving the name of the exposure covariate in
\code{model} that equals \code{A - X} (default \code{"AW"}). This must
appear in \code{model} and in \code{data_yXZ}.}
}
\value{
A list with components:
\describe{
\item{beta_est}{1 x 4 matrix: \eqn{(\hat\beta_0, \hat\beta_1, \hat\beta_2, \hat\psi)}.}
\item{se_est}{1 x 3 matrix of standard errors for \eqn{\beta_0, \beta_1, \beta_2}
based on the geex sandwich estimator.}
}
}
\description{
Fits a regression model for \code{y} using an augmented IPW estimator
with a closed-form ("lambda-close") augmentation under a normal
approximation for \code{X}. This implementation assumes the outcome
model is \code{y ~ AW + Z}, where \code{AW = A - X}, and uses a
single covariate \code{Z} in the outcome model.
}
\details{
The estimator combines:
\itemize{
\item an IPW component using weights \code{D / p}, where \code{p}
is chosen via \code{myweight}, and
\item a closed-form augmentation term derived under a normal
approximation for \code{X}.
}
}
