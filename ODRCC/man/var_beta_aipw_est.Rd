% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/var_beta_aipw.R
\name{var_beta_aipw_est}
\alias{var_beta_aipw_est}
\title{Sandwich variance estimator for the AIPW estimator}
\usage{
var_beta_aipw_est(
  data_yXZ,
  theta,
  model,
  model_weights,
  gamma_x,
  model_xz,
  aw_var = "AW",
  lbound = 0,
  ubound = 50
)
}
\arguments{
\item{data_yXZ}{Data frame containing at least:
\itemize{
\item \code{y}: outcome,
\item \code{A}: auxiliary covariate used to form \code{AW = A - X},
\item \code{W}: observed covariate \code{W = min(X, C)},
\item \code{D}: indicator \code{I(X \le C)},
\item all covariates appearing in \code{model},
\item all covariates appearing in \code{model_weights} and \code{model_xz}.
}}

\item{theta}{Numeric vector \code{c(beta, psi)} from the AIPW estimator,
where \code{beta} has length equal to the number of columns in
\code{model.matrix(model, data_yXZ)} and \code{psi} is the residual
standard deviation.}

\item{model}{\code{\link[stats]{formula}} for the outcome, e.g.
\code{y ~ AW + Z} or \code{y ~ AW + Z1 + Z2}.}

\item{model_weights}{\code{\link[stats]{formula}} specifying the censoring
model for \code{C | (Y, Z, ...)}. Typically a RHS-only formula such as
\code{~ y + Z}, which is internally expanded to
\code{Surv(W, 1 - D) ~ y + Z}.}

\item{gamma_x}{Numeric vector of parameters for the \code{X | Z} AFT model:
\code{gamma_x = c(gamma_coef, shape_par)}, where \code{gamma_coef} indexes
\code{log-mean(X | Z)} and \code{shape_par} is the AFT scale parameter
used via \code{shape.x = 1 / shape_par}.}

\item{model_xz}{\code{\link[stats]{formula}} for the covariate structure
of \code{X | Z}, typically RHS-only such as \code{~ Z}. Only the RHS is
used.}

\item{aw_var}{Character, name of the exposure covariate in \code{model} that
equals \code{A - X} (default \code{"AW"}).}

\item{lbound, ubound}{Numeric lower and upper bounds for the numerical
integration over \code{X} in the augmentation term (defaults: 0, 50).}
}
\value{
A list with components
\describe{
\item{beta_est}{Estimated regression coefficients \eqn{\beta}.}
\item{psi_est}{Estimated residual standard deviation \eqn{\psi}.}
\item{se_beta}{Sandwich standard errors for \eqn{\beta}.}
\item{sandwich_var}{Full sandwich variance matrix for \eqn{\beta}.}
}
}
\description{
Computes a plug-in sandwich variance estimator for the AIPW regression
estimator under outcome-dependent right-censoring of a covariate. The
outcome model is specified by \code{model}, typically of the form
\code{y ~ AW + Z1 + ... + Zp}, where \code{AW = A - X}.
}
\details{
The AIPW estimator combines:
\itemize{
\item an IPW component based on a censoring model for
\code{C | (Y, Z, ...)} specified by \code{model_weights}, and
\item an augmentation component based on an AFT model for
\code{X | Z} specified by \code{gamma_x} and \code{model_xz}.
}

This function takes the estimated parameter vector \code{theta = c(beta, psi)}
from \code{\link{estimate_beta_aipw_est}} and computes a sandwich variance
for \eqn{\beta}, treating the nuisance model parameters as plug-in.
}
