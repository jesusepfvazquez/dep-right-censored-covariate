% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/var_beta_mle.R
\name{var_beta_mle}
\alias{var_beta_mle}
\title{Sandwich variance estimator for likelihood-based estimator}
\usage{
var_beta_mle(data_yXZ, theta, model, aw_var = "AW", model_xz = NULL)
}
\arguments{
\item{data_yXZ}{A data frame containing at least the outcome \code{y}, the
auxiliary covariate \code{A}, the observed covariate \code{W}, the event
indicator \code{D}, the exposure covariate \code{AW} (or another name
specified by \code{aw_var}), and any additional covariates appearing in
\code{model} and optionally \code{model_xz}.}

\item{theta}{Numeric vector of parameter estimates, typically taken from
\code{estimate_beta_mle(...)[["beta_est"]]}. Must be ordered
as \eqn{(\beta, \psi, \gamma_x, \text{shape}_x)}.}

\item{model}{A \code{\link[stats]{formula}} specifying the outcome regression
model, e.g. \code{y ~ AW + Z1 + Z2}.}

\item{aw_var}{Character string giving the name of the exposure covariate that
is defined as \code{A - X} (default is \code{"AW"}). This variable must
appear on the right-hand side of \code{model} and as a column in
\code{data_yXZ}.}

\item{model_xz}{Optional \code{\link[stats]{formula}} specifying the AFT model
for \code{X | Z}. If \code{NULL} (default), the model for \code{X | Z} is
taken to be Weibull with log-mean linear in \code{(1, Z1, ..., Zp)}, where
\code{Z1, ..., Zp} are all covariates on the right-hand side of
\code{model} except \code{aw_var}. If provided, \code{model_xz} can be
either a right-hand-side formula (e.g. \code{~ Z1 + Z2}) or a full Surv
formula (e.g. \code{Surv(W, D) ~ Z1 + Z2}); in both cases, only the RHS is
used here to construct the design for \code{X | Z}.}
}
\value{
A list with components
\describe{
\item{beta_est}{Estimated regression coefficients \eqn{\beta}.}
\item{psi_est}{Estimated residual standard deviation \eqn{\psi}.}
\item{se_beta}{Sandwich standard errors for \eqn{\beta}.}
\item{se_psi}{Sandwich standard error for \eqn{\psi}.}
\item{sandwich_var}{Full sandwich variance matrix for \eqn{\theta}.}
}
}
\description{
Computes a sandwich variance estimator for the parameter vector \eqn{\theta}
obtained from \code{\link{estimate_beta_likelihood_optimx}}. The function
allows for a general outcome model \code{y ~ AW + Z1 + ... + Zp} and a
possibly different AFT model for \code{X | Z} specified by \code{model_xz}.
}
\details{
The parameter vector \eqn{\theta} is assumed to be of the form
\eqn{\theta = (\beta, \psi, \gamma_x, \text{shape}_x)}, where:
\itemize{
\item \eqn{\beta} are the regression coefficients in the outcome model,
\item \eqn{\psi} is the residual standard deviation on the original scale,
\item \eqn{\gamma_x} indexes the (log-)mean of \eqn{X | Z},
\item \eqn{\text{shape}_x} is the Weibull shape parameter for \eqn{X | Z}.
}
}
