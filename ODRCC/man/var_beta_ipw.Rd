% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/var_beta_ipw.R
\name{var_beta_ipw}
\alias{var_beta_ipw}
\title{Sandwich variance estimator for the IPW estimator}
\usage{
var_beta_ipw(data_yXZ, theta, model, model_weights)
}
\arguments{
\item{data_yXZ}{A data frame containing at least the outcome \code{y}, the
covariates in the outcome model \code{model}, the observed covariate
\code{W}, the event indicator \code{D}, and the covariates appearing in the
censoring model \code{model_weights}.}

\item{theta}{Numeric vector of parameter estimates \eqn{(\beta, \psi)} from
the IPW estimator. The length of \code{theta} must be equal to
\code{p_beta + 1}, where \code{p_beta} is the number of regression
coefficients in \code{model}.}

\item{model}{A \code{\link[stats]{formula}} specifying the outcome regression
model, e.g. \code{y ~ AW + Z1 + Z2}.}

\item{model_weights}{A \code{\link[stats]{formula}} specifying the censoring
model used to estimate the IPW weights. Typically of the form
\code{~ y + Z1 + Z2} (right-hand-side only). Internally this is expanded to
\code{Surv(W, 1 - D) ~ y + Z1 + Z2}. If a full \code{Surv} formula is
provided, only its right-hand side is used.}
}
\value{
A list with components
\describe{
\item{beta_est}{Estimated regression coefficients \eqn{\beta}.}
\item{psi_est}{Estimated residual standard deviation \eqn{\psi}.}
\item{se_beta}{Sandwich standard errors for \eqn{\beta}.}
\item{sandwich_var}{Full sandwich variance matrix for the stacked nuisance
parameter vector \eqn{\xi = (\beta, \alpha)}, where
\eqn{\alpha} are the parameters of the censoring model.}
}
}
\description{
Computes a sandwich variance estimator for the IPW regression estimator,
allowing for a general outcome model \code{y ~ AW + Z1 + ... + Zp} and a
possibly different censoring model for \code{C | (Y, Z, ...)} specified by
\code{model_weights}. The censoring model is fit via a Weibull AFT model
using \code{survreg}, and the corresponding Gumbel parameterization for
\code{log(W)} is used to construct the weights \eqn{\pi(Y, W, Z)}.
}
\details{
The parameter vector \code{theta} is assumed to be of the form
\eqn{\theta = (\beta, \psi)}, where:
\itemize{
\item \eqn{\beta} are the regression coefficients in the outcome model,
\item \eqn{\psi} is the residual standard deviation on the original scale.
}
}
