% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_beta_mle.R
\name{estimate_beta_mle}
\alias{estimate_beta_mle}
\title{Likelihood-based estimator via optimx for general AW + Z model}
\usage{
estimate_beta_mle(
  data_yXZ,
  model,
  aw_var = "AW",
  model_weights,
  model_xz = NULL,
  trace = 0
)
}
\arguments{
\item{data_yXZ}{A data frame containing at least the outcome \code{y}, the
auxiliary covariate \code{A}, the observed covariate \code{W}, the event
indicator \code{D}, the exposure covariate \code{AW} (or another name
specified by \code{aw_var}), and any additional covariates appearing in
\code{model} and optionally \code{model_xz}.}

\item{model}{A \code{\link[stats]{formula}} specifying the outcome regression
model, e.g. \code{y ~ AW + Z1 + Z2}.}

\item{aw_var}{Character string giving the name of the exposure covariate that
is defined as \code{A - X} (default is \code{"AW"}). This variable must
appear on the right-hand side of \code{model} and as a column in
\code{data_yXZ}.}

\item{model_weights}{A right-hand-side formula specifying the variables in
the censoring model, e.g. \code{~ y + Z}. This will be expanded to
\code{Surv(W, 1 - D) ~ y + Z} internally. This is needed so that we can compute
an initial ``good" estimate for our regression parameters using the IPW estimator.}

\item{model_xz}{Optional \code{\link[stats]{formula}} specifying the AFT model
for \code{X | Z}. If \code{NULL} (default), the model for \code{X | Z} is
taken to be Weibull with log-mean linear in \code{(1, Z1, ..., Zp)}, where
\code{Z1, ..., Zp} are all covariates on the right-hand side of
\code{model} except \code{aw_var}. If provided, \code{model_xz} can be either
a full Surv formula such as \code{Surv(W, D) ~ Z1 + Z2} or a right-hand-side
formula such as \code{~ Z1 + Z2}, in which case the left-hand side
\code{Surv(W, D)} is filled in automatically.
' @param trace Optional, set equal to 1 if you want the trace of the optimx model.
Leave at 0 if you do not want a trace}
}
\value{
A list with component
\describe{
\item{beta_est}{A numeric vector containing the parameter vector
\eqn{\theta = (\beta, \psi, \gamma_x, \text{shape}_x)}, where
\eqn{\beta} are the outcome regression coefficients (dimension determined
by \code{model}), \eqn{\psi} is the residual standard deviation on the
original scale, \eqn{\gamma_x} indexes the mean of \eqn{X | Z}, and
\eqn{\text{shape}_x} is the Weibull shape parameter for \eqn{X | Z}.}
}
}
\description{
Fits a parametric likelihood model for the outcome and the right-censored
covariate using direct maximization of the log-likelihood with
\code{optimx}. The outcome model is specified by \code{model}, typically of
the form \code{y ~ AW + Z1 + ... + Zp}, where \code{AW = A - X}. The
distribution of \code{X | Z} is modeled via a Weibull AFT model, whose
covariate structure can be specified by \code{model_xz} or, by default,
derived from the right-hand side of \code{model} by excluding \code{AW}.
}
