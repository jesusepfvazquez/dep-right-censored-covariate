% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/var_beta_aipw.R
\name{var_beta_aipw}
\alias{var_beta_aipw}
\title{Sandwich variance estimator for the AIPW estimator}
\usage{
var_beta_aipw(data_yXZ, theta, lbound = 0, ubound = 50)
}
\arguments{
\item{data_yXZ}{Data frame containing at least:
\itemize{
\item \code{y}: outcome,
\item \code{A}: auxiliary covariate used to form \code{AW = A - X},
\item \code{W}: observed covariate \code{W = min(X, C)},
\item \code{D}: indicator \code{I(X <= C)},
\item all covariates appearing in \code{model},
\item all covariates appearing in \code{model_weights} and \code{model_xz}.
}}

\item{theta}{Numeric vector \code{c(beta, psi)} from the AIPW estimator,
where \code{beta} has length equal to the number of columns in
\code{model.matrix(model, data_yXZ)} and \code{psi} is the residual
standard deviation.}

\item{lbound, ubound}{Numeric lower and upper bounds for the numerical
integration over \code{X} in the augmentation term (defaults: 0, 50).}
}
\value{
A list with components
\describe{
\item{beta_est}{Estimated regression coefficients \eqn{\beta}.}
\item{psi_est}{Estimated residual standard deviation \eqn{\psi}.}
\item{se_beta}{Sandwich standard errors for \eqn{\beta}.}
}
}
\description{
Computes a plug-in sandwich variance estimator for the AIPW regression
estimator under outcome-dependent right-censoring of a covariate. The
outcome model is specified by \code{model}, typically of the form
\code{y ~ AW + Z1 + ... + Zp}, where \code{AW = A - X}.
}
\details{
The AIPW estimator combines:
\itemize{
\item an IPW component based on a censoring model for
\code{C | (Y, Z, ...)} specified by \code{model_weights}, and
\item an augmentation component based on an AFT model for
\code{X | Z} specified by \code{gamma_x} and \code{model_xz}.
}

This function takes the estimated parameter vector \code{theta = c(beta, psi)}
from \code{\link{estimate_beta_aipw_est}} and computes a sandwich variance
for \eqn{\beta}, treating the nuisance model parameters as plug-in.
}
